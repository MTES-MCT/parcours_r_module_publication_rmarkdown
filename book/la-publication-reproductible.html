<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 2 La publication reproductible | Module 6 - Publications reproductibles avec RMarkdown</title>
  <meta name="description" content="Chapitre 2 La publication reproductible | Module 6 - Publications reproductibles avec RMarkdown" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 2 La publication reproductible | Module 6 - Publications reproductibles avec RMarkdown" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 2 La publication reproductible | Module 6 - Publications reproductibles avec RMarkdown" />
  
  
  

<meta name="author" content="Groupe des référents R" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="bien-commencer.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><p style="text-align:center;"><img src="https://mtes-mct.github.io/parcours-r/assets/images/logo_marianne_fond_blanc.png" style="width:100px;"/></p></li>
<li><a href="./">Découvrir R et RStudio</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#le-parcours-de-formation"><i class="fa fa-check"></i><b>1.1</b> Le parcours de formation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#objectifs-du-module-6"><i class="fa fa-check"></i><b>1.2</b> Objectifs du module 6</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#exemples-de-productions-avec-r-markdown"><i class="fa fa-check"></i><b>1.3</b> Exemples de productions avec R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="la-publication-reproductible.html"><a href="la-publication-reproductible.html"><i class="fa fa-check"></i><b>2</b> La publication reproductible</a>
<ul>
<li class="chapter" data-level="2.1" data-path="la-publication-reproductible.html"><a href="la-publication-reproductible.html#définition"><i class="fa fa-check"></i><b>2.1</b> Définition</a></li>
<li class="chapter" data-level="2.2" data-path="la-publication-reproductible.html"><a href="la-publication-reproductible.html#bonnes-pratiques"><i class="fa fa-check"></i><b>2.2</b> Bonnes pratiques</a></li>
<li class="chapter" data-level="2.3" data-path="la-publication-reproductible.html"><a href="la-publication-reproductible.html#origine-du-format-r-markdown"><i class="fa fa-check"></i><b>2.3</b> Origine du format <em>R markdown</em></a></li>
<li class="chapter" data-level="2.4" data-path="la-publication-reproductible.html"><a href="la-publication-reproductible.html#du-.rmd-au-format-de-sortie"><i class="fa fa-check"></i><b>2.4</b> Du .Rmd au format de sortie</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bien-commencer.html"><a href="bien-commencer.html"><i class="fa fa-check"></i><b>3</b> Bien commencer</a>
<ul>
<li class="chapter" data-level="3.1" data-path="bien-commencer.html"><a href="bien-commencer.html#créer-un-projet-sous-rstudio-pour-vous-permettre-de-recencer-vos-travaux."><i class="fa fa-check"></i><b>3.1</b> Créer un projet sous Rstudio pour vous permettre de recencer vos travaux.</a></li>
<li class="chapter" data-level="3.2" data-path="bien-commencer.html"><a href="bien-commencer.html#intégrer-vos-données"><i class="fa fa-check"></i><b>3.2</b> Intégrer vos données</a></li>
<li class="chapter" data-level="3.3" data-path="bien-commencer.html"><a href="bien-commencer.html#activer-les-packages-nécessaires"><i class="fa fa-check"></i><b>3.3</b> Activer les packages nécessaires</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="le-fichier-r-markdown.html"><a href="le-fichier-r-markdown.html"><i class="fa fa-check"></i><b>4</b> Le fichier <em>R Markdown</em></a>
<ul>
<li class="chapter" data-level="4.1" data-path="le-fichier-r-markdown.html"><a href="le-fichier-r-markdown.html#créer-un-fichier"><i class="fa fa-check"></i><b>4.1</b> Créer un fichier</a></li>
<li class="chapter" data-level="4.2" data-path="le-fichier-r-markdown.html"><a href="le-fichier-r-markdown.html#rmarkdown-dans-rstudio"><i class="fa fa-check"></i><b>4.2</b> Rmarkdown dans RStudio</a></li>
<li class="chapter" data-level="4.3" data-path="le-fichier-r-markdown.html"><a href="le-fichier-r-markdown.html#les-éléments-dun-fichier-.rmd"><i class="fa fa-check"></i><b>4.3</b> Les éléments d’un fichier .Rmd</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="le-fichier-r-markdown.html"><a href="le-fichier-r-markdown.html#les-éléments-texte"><i class="fa fa-check"></i><b>4.3.1</b> Les éléments texte</a></li>
<li class="chapter" data-level="4.3.2" data-path="le-fichier-r-markdown.html"><a href="le-fichier-r-markdown.html#les-chunks"><i class="fa fa-check"></i><b>4.3.2</b> Les <em>chunks</em></a></li>
<li class="chapter" data-level="4.3.3" data-path="le-fichier-r-markdown.html"><a href="le-fichier-r-markdown.html#insérer-des-images"><i class="fa fa-check"></i><b>4.3.3</b> Insérer des images</a></li>
<li class="chapter" data-level="4.3.4" data-path="le-fichier-r-markdown.html"><a href="le-fichier-r-markdown.html#insérer-des-éléments-en-latex"><i class="fa fa-check"></i><b>4.3.4</b> Insérer des éléments en <span class="math inline">\(\LaTeX\)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="paramétrage.html"><a href="paramétrage.html"><i class="fa fa-check"></i><b>5</b> Paramétrage</a>
<ul>
<li class="chapter" data-level="5.1" data-path="paramétrage.html"><a href="paramétrage.html#paramétrage-général-du-fichier-.rmd"><i class="fa fa-check"></i><b>5.1</b> Paramétrage général du fichier .Rmd</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="a-ne-pas-oublier.html"><a href="a-ne-pas-oublier.html"><i class="fa fa-check"></i><b>6</b> A ne pas oublier</a></li>
<li class="chapter" data-level="7" data-path="rappels-du-jour-1.html"><a href="rappels-du-jour-1.html"><i class="fa fa-check"></i><b>7</b> Rappels du jour 1</a></li>
<li class="chapter" data-level="8" data-path="exercice.html"><a href="exercice.html"><i class="fa fa-check"></i><b>8</b> Exercice</a>
<ul>
<li class="chapter" data-level="8.1" data-path="exercice.html"><a href="exercice.html#cadrage"><i class="fa fa-check"></i><b>8.1</b> Cadrage</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="exercice.html"><a href="exercice.html#problématique"><i class="fa fa-check"></i><b>8.1.1</b> Problématique</a></li>
<li class="chapter" data-level="8.1.2" data-path="exercice.html"><a href="exercice.html#rendu"><i class="fa fa-check"></i><b>8.1.2</b> Rendu</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="interactive-documents-an-r-markdown-file-that-contains-shiny-components-and-can-be-an-app-or-used-within-a-report.html"><a href="interactive-documents-an-r-markdown-file-that-contains-shiny-components-and-can-be-an-app-or-used-within-a-report.html"><i class="fa fa-check"></i><b>9</b> Interactive Documents - an R Markdown file that contains Shiny components and can be an app or used within a report</a></li>
<li class="divider"></li>
<li><a href="https://mtes-mct.github.io/parcours-r/">Liste des formations R</a></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Module 6 - Publications reproductibles avec RMarkdown</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="la-publication-reproductible" class="section level1" number="2">
<h1><span class="header-section-number">Chapitre 2</span> La publication reproductible</h1>
<div id="définition" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Définition</h2>
<p>Le schéma classique pour produire un rapport ou une publication ressemble à ça :</p>
<p><img src="images/schema_publi.png" /></p>
<p>Les données mobilisées proviennent de bases de données, de tables ou de SIG, et rien que pour les lire, il y a besoin de plusieurs logiciels selon les formats.</p>
<p>Les données sont ensuite nettoyées (valeurs manquantes ou aberrantes, recodages, discrétisation, renommages …), puis traitées (sélection, agrégation, modélisation) et visualisées (tables, graphiques, cartes). Les éléments visuels sont insérés dans un traitement de texte qui sert aussi à la rédaction, et enfin la version diffusable est produite au format pdf.</p>
<p>Plusieurs inconvénients à cette chaîne d’opérations :</p>
<ul>
<li>Beaucoup d’opérations manuelles chronophages et sources potentielles d’erreurs.</li>
<li>Si quelque chose change, il faut tout recommencer (mise à jour, adaptation à une autre zone géographique ou fenêtre temporelle).</li>
<li>La publication finale n’est pas “reproductible” au sens où la traçabilité est insuffisante pour qu’un autre auteur, avec les mêmes données, arrive à la même publication <span class="math inline">\(\Rightarrow\)</span> la recherche d’erreurs est difficile et les passations délicates.</li>
<li>Les contenus sont statiques, ce qui est peu attractif par rapport aux possibilités d’interactivité offertes par les technologies web.</li>
</ul>
<p>Le fil conducteur de ce module est la production de A à Z d’un portrait de territoire, à partir de données variées, en travaillant entièrement dans RStudio au format R Markdown.</p>
<blockquote>
<p>On appelle ici “publication reproductible” un document élaboré à partir de données et dont tout le code est fourni. C’est la disponibilité du code qui rend l’analyse réplicable, indépendament de la qualité de la documentation qui peut être fournie.</p>
</blockquote>
<p>Travailler ainsi a pour avantages majeurs une plus grande facilité quand il s’agit de :</p>
<ul>
<li>Rechercher d’éventuelles erreurs</li>
<li>Justifier précisément les analyses réalisées, les pré-traitements et autres choix méthodologiques</li>
<li>Mettre à jour la publication</li>
<li>Modifier le code par exemple pour l’adapter à unnouveau document</li>
<li>Partager une méthode</li>
</ul>
<p>La transparence dans le traitement de l’information est importante en termes de crédibilité pour les institutions. <a href="https://fr.wikipedia.org/wiki/Crise_de_la_reproductibilit%C3%A9">Selon Wikipedia</a>, qui parle de “crise de la reproductibilité”, une part très importante des études publiées dans des revues prestigieuses ne sont pas réplicables.</p>
<p>Un MOOC intitulé “Recherche reproductible : principes méthodologiques pour une science transparente” est périodiquement proposé sur la <a href="https://www.fun-mooc.fr/">plateforme France Université Numérique</a>. Contrairement à ce que suggère son titre, des non-chercheurs peuvent tout à fait le suivre car ses principes sont pleinement applicables aux métiers qui font appel à la donnée en général. Tous les exercices peuvent être faits avec R et RStudio.</p>
</div>
<div id="bonnes-pratiques" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Bonnes pratiques</h2>
<p>On vise à assurer la continuité et la traçabilité coomplète de la chaîne de traitement depuis la donnée brute (fichiers sources fournis par les producteurs, millésimés) jusqu’au document final. Par exemple on ne supprime pas “à la main” des données qui sembleraient aberrantes.</p>
<p>Les choix méthodologiques sont documentés.</p>
<p>Travail est organisé en mode projet avec des fichiers localisés dans une arborescence classique avec archivage des millésimes des jeux de données mobilisés.</p>
</div>
<div id="origine-du-format-r-markdown" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Origine du format <em>R markdown</em></h2>
<p><img src="images/rmarkdown.png" width="25%" style="display: block; margin: auto;" /></p>
<p>Ce format de document a été introduit en 2012 à la sortie du package <code>knitr</code>.</p>
<p>Auparavant, il existait Markdown, un “langage de balisage léger”, sorte d’intermédiaire entre du texte brut et du traitement de texte. La syntaxe de Markdown est très simplifiée. On peut le saisir avec un éditeur de texte comme <em>Notepad</em> et il est lisible même non formaté.</p>
<p>Pourquoi utiliser un langage de balisage léger ? Des avantages majeurs :</p>
<ul>
<li>Séparer le fond de la forme. On peut taper “au kilomètre” en se concentrant sur le contenu, et voir ensuite les questions de forme (y compris le format de sortie, HTML, PDF, traitements de texte, diaporamas, tableaux de bord, voire EPUB).</li>
<li>Cette simplicité permet le suivi de version par des outils comme <a href="https://fr.wikipedia.org/wiki/Git">Git</a>.</li>
</ul>
<p>Par contre, la simplicité signifie peu de fonctionnalités donc des sorties assez pauvres.</p>
<p>L’idée, avec R Markdown, était garder les avantages du langage existant Markdown mais en lui ajoutant des fonctionnalités d’interprétation de code R, intégré aux documents sous formes de <code>chunks</code>. En fait, les versions actuelles du package <code>knitr</code> permettent d’interpréter d’autres langages comme du <span class="math inline">\(\LaTeX\)</span> ou du code Python.</p>
<p>R Markdown est en quelque sorte un cadre pour travailler en data science. Un même document permet de sauvegarder et exécuter du code ainsi que de produire des rapports mis en forme pouvant contenir une grande diversité d’objets statiques ou dynamiques.</p>
</div>
<div id="du-.rmd-au-format-de-sortie" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Du .Rmd au format de sortie</h2>
<p><img src="images/render.png" /></p>
<p>On distingue deux étapes :</p>
<ul>
<li>La première, réalisée par le package knitr, interprète le document R Markdown et exécute les morceaux de code. Elle produit un fichier Markdown contenant le texte, le code et le résultat de l’exécution du code.</li>
<li>Puis, le convertisseur de formats Pandoc se charge de produire le document de sortie au format choisi.</li>
</ul>
<p>Ca peut paraître compliqué mais en pratique, chacune des fonctions <code>render</code> de <code>knitr</code> exécute la chaîne du début à la fin.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bien-commencer.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["support-documents-reproductibles.pdf", "support-documents-reproductibles.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
